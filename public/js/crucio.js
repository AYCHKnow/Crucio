"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TimeAgo(){var e={prefixAgo:"vor",prefixFromNow:"in",suffixAgo:"",suffixFromNow:"",seconds:"wenigen Sekunden",minute:"etwa einer Minute",minutes:"%d Minuten",hour:"etwa einer Stunde",hours:"%d Stunden",day:"etwa einem Tag",days:"%d Tagen",month:"etwa einem Monat",months:"%d Monaten",year:"etwa einem Jahr",years:"%d Jahren",wordSeparator:" ",numbers:[]};return{restrict:"A",link:function(t,s,n){n.$observe("timeago",function(){function t(e){var t={};return e&&"[object Function]"===t.toString.call(e)}function i(n,i){var r=t(n)?s(i,l):n,o=e.numbers&&e.numbers[i]||i;return r.replace(/%d/i,o)}function r(e){return e.replace(/^\s+|\s+$/g,"")}var o=parseInt(n.timeago,0),a=(new Date).getTime(),l=Math.abs(a-o),u=l/1e3,c=u/60,h=c/60,m=h/24,d=m/365,f=e.prefixAgo,v=e.suffixAgo,g=45>u&&i(e.seconds,Math.round(u))||90>u&&i(e.minute,1)||45>c&&i(e.minutes,Math.round(c))||90>c&&i(e.hour,1)||24>h&&i(e.hours,Math.round(h))||42>h&&i(e.day,1)||30>m&&i(e.days,Math.round(m))||45>m&&i(e.month,1)||365>m&&i(e.months,Math.round(m/30))||1.5>d&&i(e.year,1)||i(e.years,Math.round(d)),_=r([f,g,v].join(e.wordSeparator));s.text(_)})}}}function Cut(){return function(e,t,s,n){if(!e)return"";var i=parseInt(s,10);if(e.length<=i)return e;var r=e.substr(0,i);if(t){var o=r.lastIndexOf(" ");-1!==o&&(r=r.substr(0,o))}return r+(n||" ?")}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}angular.module("crucioApp",["ngRoute","ngSanitize","ngCookies","ngMessages","ngTagsInput","ui.bootstrap","angular-loading-bar","angularFileUpload","angularSpinner","textAngular","angles","rzModule","duScroll"]).config(["$routeProvider","$locationProvider",function(e,t){function s(e,t){return{templateUrl:"views/"+e+".html",controller:t,controllerAs:"ctrl"}}e.when("/learn",s("learn","LearnController")).when("/author",s("author","AuthorController")).when("/admin",s("admin","AdminController")).when("/global-statistic",s("global-statistic","GlobalStatisticController")).when("/account",s("account","AccountController")).when("/settings",s("settings","SettingsController")).when("/edit-exam",s("edit-exam","EditExamController")).when("/question",s("question","QuestionController")).when("/exam",s("exam","ExamController")).when("/statistic",s("statistic","StatisticController")).when("/analysis",s("analysis","AnalysisController")).when("/help",s("help","HelpController")).when("/403",s("403","ErrorController")).when("/404",s("404","ErrorController")).when("/500",s("500","ErrorController")).otherwise({redirectTo:"/404"}),t.html5Mode(!0)}]).run(["Auth","$location","$window",function(e,t,s){function n(e,t){var s=t;return t.includes("?")&&(s=t.substr(0,t.indexOf("?"))),e.includes(s)}var i=["/","/register","/forgot-password"],r=["/author","/edit-exam"],o=["/admin","/global-statistic"],a=e.tryGetUser(),l=!1,u=!1,c=!1;a&&(l=Boolean(a.group_id),u=Boolean(2===a.group_id),c=Boolean(3===a.group_id));var h=t.url();n(i,h)&&l&&a.remember_user&&s.location.replace("/learn"),!n(r,h)||c||u||s.location.replace("/403"),n(o,h)&&!u&&s.location.replace("/403")}]);var AboutController=function e(){_classCallCheck(this,e)};angular.module("crucioApp").controller("AboutController",AboutController);var ActivateController=function t(e,s,n){var i=this;if(_classCallCheck(this,t),this.API=s,this.user=e.tryGetUser(),this.token=n.search().token,this.token){var r={token:this.token};this.API.put("users/activate",r).success(function(e){i.success=e.status,i.errorNoToken="error_no_token"===e.error,i.errorUnknown="error_unknown"===e.error})}else this.success=!1,this.errorNoToken=!0};ActivateController.$inject=["Auth","API","$location"],angular.module("crucioApp").controller("ActivateController",ActivateController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),AdminController=function(){function e(t,s,n,i){var r=this;_classCallCheck(this,e),this.API=n,this.$uibModal=i,t.setTitleAndNav("Verwaltung | Crucio","Admin"),this.activeTab="users",this.user=s.getUser(),this.user_search={},this.comment_search={},this.API.get("whitelist").success(function(e){r.whitelist=e.whitelist}),this.API.get("stats/summary").success(function(e){r.stats=e.stats}),this.API.get("users/distinct").success(function(e){r.distinct_groups=e.groups,r.distinct_semesters=e.semesters}),this.loadUsers(),this.loadComments()}return e.$inject=["Page","Auth","API","$uibModal"],_createClass(e,[{key:"loadUsers",value:function(){var e=this,t={semester:this.user_search.semester,group_id:this.user_search.group,query:this.user_search.query,limit:100};this.API.get("users",t).success(function(t){e.users=t.users})}},{key:"loadComments",value:function(){var e=this,t={query:this.comment_search.query,limit:50};this.API.get("comments",t).success(function(t){e.comments=t.comments,e.questions_by_comment=[];var s=!0,n=!1,i=void 0;try{for(var r,o=e.comments[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){for(var a=r.value,l=-1,u=0;u<e.questions_by_comment.length;u++)if(e.questions_by_comment[u][0].question===a.question){l=u;break}l>-1?e.questions_by_comment[l].push(a):e.questions_by_comment.push([a])}}catch(c){n=!0,i=c}finally{try{!s&&o["return"]&&o["return"]()}finally{if(n)throw i}}e.questions_by_comment_display=e.questions_by_comment})}},{key:"addMail",value:function(){var e=this.new_whitelist_mail;if(e){this.whitelist.push({username:"",mail_address:e});var t={mail_address:e.replace("@","(@)")};this.API.post("whitelist",t)}}},{key:"removeMail",value:function(e){var t=this.whitelist[e].mail_address;t&&(this.whitelist.splice(e,1),this.API["delete"]("whitelist/"+t))}},{key:"changeGroup",value:function(e){var t=this.users[e].user_id,s=this.users[e].group_id;s=s%this.distinct_groups.length+1,this.users[e].group_id=s;var n=!0,i=!1,r=void 0;try{for(var o,a=this.distinct_groups[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.group_id===s){this.users[e].group_name=l.name;break}}}catch(u){i=!0,r=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(i)throw r}}var c={group_id:s};this.API.put("users/"+t+"/group",c,!0)}},{key:"isToday",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],s=new Date,n=s-36e5*t,i=new Date(n),r=new Date(1e3*e);return i.toDateString()===r.toDateString()}},{key:"changeSemester",value:function(e){var t={number:e};this.API.put("users/change-semester",t).success(function(e){alert(e.status)})}},{key:"removeTestAccount",value:function(){this.API["delete"]("users/test-account").success(function(e){alert(e.status)})}}]),e}();angular.module("crucioApp").controller("AdminController",AdminController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),GlobalStatisticController=function(){function e(t,s,n,i){var r=this;_classCallCheck(this,e),this.API=n,t.setTitleAndNav("Statistik | Crucio","Admin"),this.activeTab="stats",this.user=s.getUser(),this.updateActivity=!1,this.showActivity={result:!1,login:!1,register:!1,comment:!1,exam_new:!1,exam_update:!1},i(function(){r.updateActivity&&r.loadActivity()},2500),this.loadData(),this.loadActivity()}return e.$inject=["Page","Auth","API","$interval"],_createClass(e,[{key:"loadData",value:function(){var e=this;this.API.get("stats/general").success(function(t){e.stats=t.stats,e.chart_time_result_today={labels:e.stats.result_dep_time_today_label,datasets:[{label:"Result dep Time",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:e.stats.result_dep_time_today}]}})}},{key:"loadActivity",value:function(){var e=this;this.API.get("stats/activities",this.showActivity,!0).success(function(t){e.activities=t.activities})}}]),e}();angular.module("crucioApp").controller("GlobalStatisticController",GlobalStatisticController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),AuthorController=function(){function e(t,s,n,i){var r=this;_classCallCheck(this,e),this.API=n,this.$location=i,t.setTitleAndNav("Autor | Crucio","Autor"),this.activeTab="exams",this.user=s.getUser(),this.exam_search={author:this.user},this.comment_search={author:this.user},this.API.get("exams/distinct").success(function(e){r.distinct_semesters=e.semesters,r.distinct_authors=e.authors,r.distinct_subjects=e.subjects}),this.API.get("subjects").success(function(e){r.subject_list=e.subjects}),this.loadExams(),this.loadComments()}return e.$inject=["Page","Auth","API","$location"],_createClass(e,[{key:"loadExams",value:function(){var e=this,t={subject_id:this.exam_search.subject&&this.exam_search.subject.subject_id,author_id:this.exam_search.author&&this.exam_search.author.user_id,semester:this.exam_search.semester,query:this.exam_search.query,limit:200};this.API.get("exams",t).success(function(t){e.exams=t.exams})}},{key:"loadComments",value:function(){var e=this,t={author_id:this.comment_search.author&&this.comment_search.author.user_id,query:this.comment_search.query,limit:100};this.API.get("comments/author",t).success(function(t){e.comments=t.comments,e.questions_by_comment=[];var s=!0,n=!1,i=void 0;try{for(var r,o=e.comments[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){for(var a=r.value,l=-1,u=0;u<e.questions_by_comment.length;u++)if(e.questions_by_comment[u][0].question===a.question){l=u;break}l>0?e.questions_by_comment[l].push(a):e.questions_by_comment.push([a])}}catch(c){n=!0,i=c}finally{try{!s&&o["return"]&&o["return"]()}finally{if(n)throw i}}e.questions_by_comment.sort(function(e,t){return t[0].date-e[0].date}),e.questions_by_comment_display=e.questions_by_comment})}},{key:"newExam",value:function(){var e=this,t={subject_id:1,user_id_added:this.user.user_id,professor:"",semester:"",date:"",type:"",duration:"",notes:""};this.API.post("exams",t).success(function(t){e.$location.path("/edit-exam").search("id",t.exam_id)})}}]),e}();angular.module("crucioApp").controller("AuthorController",AuthorController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),EditExamController=function(){function e(t,s,n,i,r,o,a){var l=this;_classCallCheck(this,e),this.API=n,this.FileUploader=i,this.$location=o,t.setTitleAndNav("Klausur | Crucio","Autor"),this.user=s.getUser(),this.examId=a.id,this.openQuestionId=a.question_id,this.openQuestionIndex=-1,this.numberChanged=0,this.uploader=new i({url:"/api/v1/file/upload"}),this.uploader.onSuccessItem=function(e,t){l.exam.file_name=t.upload_name},this.uploaderArray=[],r.$watch(function(){return l.exam},function(){l.hasChanged=l.numberChanged>1,l.numberChanged+=1},!0),r.$on("$locationChangeStart",function(e){if(l.hasChanged){var t=confirm("Die Änderungen an der Klausur bleiben dann ungespeichert. Wirklich verlassen?");t||e.preventDefault()}}),this.API.get("subjects").success(function(e){l.subject_list=e.subjects}),this.loadExam()}return e.$inject=["Page","Auth","API","FileUploader","$scope","$location","$routeParams"],_createClass(e,[{key:"loadExam",value:function(){var e=this;this.API.get("exams/"+this.examId).success(function(t){e.exam=t.exam,e.questions=t.questions;for(var s=0;s<e.questions.length;s++)e.questions[s].question_id===e.openQuestionId&&(e.openQuestionIndex=s);e.remakeUploaderArray(),0===e.questions.length&&e.addQuestion(!1),e.ready=!0})}},{key:"getCategories",value:function(e){var t=!0,s=!1,n=void 0;try{for(var i,r=this.subject_list[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;if(o.subject_id===e)return o.categories}}catch(a){s=!0,n=a}finally{try{!t&&r["return"]&&r["return"]()}finally{if(s)throw n}}}},{key:"remakeUploaderArray",value:function(){var e=this;this.uploaderArray=[];for(var t=0;t<this.questions.length;t++){var s=new this.FileUploader({url:"/api/v1/file/upload",formData:t});s.onSuccessItem=function(t,s){var n=t.formData;e.questions[n].question_image_url=s.upload_name},this.uploaderArray.push(s)}}},{key:"addQuestion",value:function(e){var t={category_id:0,question:"",type:5,correct_answer:0,answers:["","","","","",""]};this.questions.push(t),e&&(this.openQuestionIndex=this.questions.length-1),this.remakeUploaderArray()}},{key:"deleteQuestion",value:function(e){var t=this.questions[e].question_id;t&&this.API["delete"]("questions/"+t),this.questions.splice(e,1),this.openQuestionIndex=Math.min(this.openQuestionIndex,this.questions.length-1),this.remakeUploaderArray(),this.questions||this.addQuestion(1)}},{key:"saveExam",value:function(){var e=this,t=this.exam.subject_id&&this.exam.semester>0&&this.exam.semester<=50&&this.exam.date;if(t){this.isSaving=!0,this.API.put("exams/"+this.examId,this.exam);var s=!0,n=!1,i=void 0;try{for(var r,o=function(){var t=r.value,s=t.question||t.question_id;if(s){t.explanation=t.explanation||"",t.question_image_url=t.question_image_url||"";var n={exam_id:e.exam.exam_id,user_id_added:e.user.user_id,category_id:t.category_id,question:t.question,type:t.type,answers:t.answers,correct_answer:t.correct_answer,explanation:t.explanation,question_image_url:t.question_image_url};t.question_id?e.API.put("questions/"+t.question_id,n):e.API.post("questions",n).success(function(e){t.question_id=e.question_id})}},a=this.questions[Symbol.iterator]();!(s=(r=a.next()).done);s=!0)o()}catch(l){n=!0,i=l}finally{try{!s&&a["return"]&&a["return"]()}finally{if(n)throw i}}this.hasChanged=!1,this.isSaving=!1}else alert("Es fehlen noch allgemeine Infos zur Klausur.")}},{key:"deleteExam",value:function(){var e=this;this.API["delete"]("exams/"+this.exam.exam_id).success(function(){e.$location.url("/author")})}}]),e}();angular.module("crucioApp").controller("EditExamController",EditExamController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),ContactController=function(){function e(t,s,n,i){_classCallCheck(this,e),this.API=s,this.$uibModal=i,this.user=t.tryGetUser(),this.user&&(this.name=this.user.username,this.mail=this.user.email)}return e.$inject=["Auth","API","$location","$uibModal"],_createClass(e,[{key:"sendMail",value:function(){var e=this;this.isWorking=!0;var t={text:this.text,name:this.name,email:this.mail.replace("@","(@)")};this.API.post("contact/send-mail",t).success(function(t){e.emailSend=t.status,t.status&&e.$uibModal.open({templateUrl:"myModalContent.html"}),e.isWorking=!1})}}]),e}();angular.module("crucioApp").controller("ContactController",ContactController);var ErrorController=function s(e){_classCallCheck(this,s),e.setTitleAndNav("Fehler | Crucio","")};ErrorController.$inject=["Page"],angular.module("crucioApp").controller("ErrorController",ErrorController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),ForgotPasswordController=function(){function e(t,s,n,i){var r=this;if(_classCallCheck(this,e),this.API=t,this.$scope=n,this.$uibModal=i,this.confirm=s.search().confirm,this.deny=s.search().deny,this.reset=!this.confirm&&!this.deny,this.confirm){this.reset=!1;var o={token:this.confirm};this.API.put("users/password/confirm",o).success(function(e){r.status=e.status,r.$uibModal.open({templateUrl:"forgotConfirmModalContent.html",controller:"ModalInstanceController",controllerAs:"ctrl",resolve:{data:function(){return r.status}}})})}if(this.deny){this.reset=!1;var o={token:this.deny};t.put("users/password/deny",o).success(function(e){r.status=e.status,r.$uibModal.open({templateUrl:"forgotDenyModalContent.html",controller:"ModalInstanceController",controllerAs:"ctrl",resolve:{data:function(){return r.status}}})})}}return e.$inject=["API","$location","$scope","$uibModal"],_createClass(e,[{key:"resetPassword",value:function(){var e=this;this.$scope.form.email.$setValidity("already",!0),this.isWorking=!0;var t={email:this.email.replace("@","(@)")};this.API.put("users/password/reset",t).success(function(t){t.status&&e.$uibModal.open({templateUrl:"forgotSucessModalContent.html"}),e.$scope.form.email.$setValidity("already","error_already_requested"!==t.error),e.isWorking=!0})}}]),e}();angular.module("crucioApp").controller("ForgotPasswordController",ForgotPasswordController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),HelpController=function(){function e(t,s,n,i,r){var o=this;_classCallCheck(this,e),this.API=n,this.Validation=i,s.setTitleAndNav("Hilfe | Crucio",""),this.user=t.getUser(),this.question_id=r.search().question_id,this.subject=r.search().s,this.question_id&&this.API.get("questions/"+this.question_id).success(function(e){o.question=e.question})}return e.$inject=["Auth","Page","API","Validation","$location"],_createClass(e,[{key:"sendMail",value:function(){var e=this,t=this.Validation.nonEmpty(this.text);if(t)if(this.isWorking=!0,this.question_id){var s={text:this.text,name:this.user.username,email:this.user.email.replace("@","(@)"),question_id:this.question_id,author:this.question.username,question:this.question.question,exam_id:this.question.exam_id,subject:this.question.subject,date:this.question.date,author_email:this.question.email,mail_subject:this.subject};this.API.post("contact/send-mail-question",s).success(function(){e.isWorking=!1,e.emailSend=!0})}else{var s={text:this.text,name:this.user.username,email:this.user.email.replace("@","(@)")};this.API.post("contact/send-mail",s).success(function(){e.isWorking=!1,e.emailSend=!0})}}}]),e}();angular.module("crucioApp").controller("HelpController",HelpController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),AnalysisController=function(){function e(t,s,n,i){function r(e,t){return Math.floor(Math.random()*(t-e+1))+e}var o=this;_classCallCheck(this,e),this.API=n,t.setTitleAndNav("Analyse | Crucio","Lernen"),this.user=s.getUser(),this.collection=i.get();var a=!0,l=!1,u=void 0;try{for(var c,h=this.collection.list[Symbol.iterator]();!(a=(c=h.next()).done);a=!0){var m=c.value;if(!m.mark_answer&&m.type>1&&m.given_result>0){var d=m.correct_answer===m.given_result?1:0;(0===m.correct_answer||1===m.question.type)&&(d=-1);var f={correct:d,question_id:m.question_id,user_id:this.user.user_id,given_result:m.given_result};this.API.post("results",f)}}}catch(v){l=!0,u=v}finally{try{!a&&h["return"]&&h["return"]()}finally{if(l)throw u}}this.random=r(0,1e3),this.examId=this.collection.exam_id,this.workedCollection=i.getWorked(),this.count=i.analyseCount(),this.examId&&this.API.get("exams/"+this.examId).success(function(e){o.exam=e.exam})}return e.$inject=["Page","Auth","API","Collection"],_createClass(e,[{key:"showCorrectAnswerClicked",value:function(e){this.workedCollection[e].show_correct_answer=1}}]),e}();angular.module("crucioApp").controller("AnalysisController",AnalysisController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),ExamController=function(){function e(t,s,n,i,r,o,a,l,u,c){var h=this;_classCallCheck(this,e),this.API=n,this.Collection=i,this.$location=r,this.$document=u,this.$uibModal=o,t.setTitleAndNav("Klausur | Crucio","Lernen"),this.user=s.getUser(),this.examId=a.id,this.collection={type:"exam",exam_id:this.examId},this.currentIndex=0,u.on("scroll",function(){for(var e=u.scrollTop(),t=function(t){var s=angular.element(c.document.getElementById("id"+t));return s.prop("offsetTop")>e?(l(function(){h.currentIndex=Math.max(t-1,0)},0),!0):void 0},s=0;s<h.collection.list.length&&!t(s);s++);}),this.loadExam()}return e.$inject=["Page","Auth","API","Collection","$location","$uibModal","$routeParams","$timeout","$document","$window"],_createClass(e,[{key:"loadExam",value:function(){var e=this;this.API.get("exams/"+this.examId).success(function(t){e.exam=t.exam,e.collection.list=t.questions})}},{key:"isHalftime",value:function(e){return Math.abs(e+1-this.questions.length/2)<1&&e>3}},{key:"saveAnswer",value:function(e,t){this.collection.list[e].given_result=t}},{key:"scrollToTop",value:function(){this.$document.scrollTopAnimated(0,400)}},{key:"handExam",value:function(){this.Collection.set(this.collection),this.$location.path("/analysis").search("id",null)}},{key:"openImageModal",value:function(e){this.$uibModal.open({templateUrl:"imageModalContent.html",controller:"ModalInstanceController",controllerAs:"ctrl",resolve:{data:function(){return e}}})}}]),e}();angular.module("crucioApp").controller("ExamController",ExamController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),LearnController=function(){function e(t,s,n,i,r,o,a){var l=this;_classCallCheck(this,e),this.API=n,this.Collection=i,this.$location=o,s.setTitleAndNav("Lernen | Crucio","Lernen"),this.activeTab="abstract",this.user=t.getUser(),this.exam_search={semester:this.user.semester},this.comment_search={},this.question_search={},this.selection_subject_list={},this.selection_number_questions=0,this.number_questions_in_choosen_subjects=0,this.slider_options={floor:0,ceil:this.number_questions_in_choosen_subjects},a(function(){r.$broadcast("rzSliderForceRender")}),r.$watch(function(){return l.number_questions_in_choosen_subjects},function(){var e=Math.min(l.number_questions_in_choosen_subjects,500);l.slider_options={floor:0,ceil:e}},!0),this.API.get("exams/distinct").success(function(e){l.distinct_semesters=e.semesters,l.distinct_subjects=e.subjects}),this.API.get("subjects").success(function(e){l.subject_list=e.subjects}),this.loadAbstract(),this.loadExams(),this.loadTags(),this.loadComments()}return e.$inject=["Auth","Page","API","Collection","$scope","$location","$timeout"],_createClass(e,[{key:"loadAbstract",value:function(){var e=this,t={limit:12};this.API.get("exams/abstract/"+this.user.user_id,t).success(function(t){e.abstract_exams=t.exams,e.ready=1})}},{key:"loadExams",value:function(){var e=this,t={user_id:this.user.user_id,semester:this.exam_search.semester,subject_id:this.exam_search.subject&&this.exam_search.subject.subject_id,query:this.exam_search.query,visibility:1};this.API.get("exams",t).success(function(t){e.exams=t.exams})}},{key:"loadTags",value:function(){var e=this,t={user_id:this.user.user_id};this.API.get("tags",t).success(function(t){e.tags=t.tags,e.distinct_tags=[];var s=!0,n=!1,i=void 0;try{for(var r,o=e.tags[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){var a=r.value,l=!0,u=!1,c=void 0;try{for(var h,m=a.tags.split(",")[Symbol.iterator]();!(l=(h=m.next()).done);l=!0){var d=h.value;e.distinct_tags.includes(d)||e.distinct_tags.push(d)}}catch(f){u=!0,c=f}finally{try{!l&&m["return"]&&m["return"]()}finally{if(u)throw c}}}}catch(f){n=!0,i=f}finally{try{!s&&o["return"]&&o["return"]()}finally{if(n)throw i}}e.questions_by_tag={};var v=!0,g=!1,_=void 0;try{for(var p,y=e.distinct_tags[Symbol.iterator]();!(v=(p=y.next()).done);v=!0){var C=p.value;e.questions_by_tag[C]=[];var b=!0,w=!1,A=void 0;try{for(var k,q=e.tags[Symbol.iterator]();!(b=(k=q.next()).done);b=!0){var a=k.value,x=!0,P=!1,$=void 0;try{for(var I,j=a.tags.split(",")[Symbol.iterator]();!(x=(I=j.next()).done);x=!0){var d=I.value;C===d&&e.questions_by_tag[C].push(a)}}catch(f){P=!0,$=f}finally{try{!x&&j["return"]&&j["return"]()}finally{if(P)throw $}}}}catch(f){w=!0,A=f}finally{try{!b&&q["return"]&&q["return"]()}finally{if(w)throw A}}}}catch(f){g=!0,_=f}finally{try{!v&&y["return"]&&y["return"]()}finally{if(g)throw _}}})}},{key:"loadComments",value:function(){var e=this,t={query:this.comment_search.query,user_id:this.user.user_id};this.API.get("comments",t).success(function(t){e.comments=t.comments,e.questions_by_comment={};var s=!0,n=!1,i=void 0;try{for(var r,o=e.comments[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){var a=r.value;e.questions_by_comment[a.question]=e.questions_by_comment[a.question]||[],e.questions_by_comment[a.question].push(a)}}catch(l){n=!0,i=l}finally{try{!s&&o["return"]&&o["return"]()}finally{if(n)throw i}}})}},{key:"loadNumberQuestions",value:function(){var e=this,t={selection:this.selection};this.API.get("questions/count",t,!0).success(function(t){e.number_questions_in_choosen_subjects=t.count,0===e.selection_number_questions&&(e.selection_number_questions=Math.min(e.number_questions_in_choosen_subjects,50)),e.selection_number_questions=Math.min(e.selection_number_questions,e.number_questions_in_choosen_subjects)})}},{key:"searchQuestion",value:function(){var e=this;if(this.searchResults=[],this.hasSearched=!1,this.question_search.query){this.showSpinner=!0;var t={query:this.question_search.query,subject_id:this.question_search.subject&&this.question_search.subject.subject_id,semester:this.question_search.semester,visibility:1,limit:100};this.API.get("questions",t,!0).success(function(t){e.searchResults=t.result,e.showSpinner=!1,e.hasSearched=!0})}}},{key:"learnExam",value:function(e){var t=this,s={random:!0};this.API.get("exams/action/prepare/"+e,s).success(function(s){var n={list:s.list,exam_id:e};t.Collection.set(n),t.$location.path("/question").search("id",n.list[0].question_id)})}},{key:"learnSubjects",value:function(){var e=this,t={selection:this.selection,limit:this.selection_number_questions};this.API.get("questions/prepare-subjects",t).success(function(s){var n={list:s.list,selection:t.selection};e.Collection.set(n),e.$location.path("/question").search("id",n.list[0].question_id)})}},{key:"resetExam",value:function(e){e.answered_questions=0,this.API["delete"]("results/"+this.user.user_id+"/"+e.exam_id,!0)}}]),e}();angular.module("crucioApp").controller("LearnController",LearnController);var ModalInstanceController=function n(e,t){_classCallCheck(this,n),this.data=e,this.$modalInstance=t};ModalInstanceController.$inject=["data","$modalInstance"],angular.module("crucioApp").controller("ModalInstanceController",ModalInstanceController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),QuestionController=function(){function e(t,s,n,i,r,o,a){if(_classCallCheck(this,e),this.Auth=t,this.API=n,this.Collection=i,this.$uibModal=a,s.setTitleAndNav("Frage | Crucio","Lernen"),this.user=t.getUser(),this.collection=this.Collection.get(),this.question_id=Number(r.id),this.resetSession=Boolean(r.reset_session),this.commentsCollapsed=Boolean(this.user.showComments),this.question_id||this.$window.location.replace("/questions"),this.noAnswer=!0,this.showExplanation=!1,this.resetSession&&(delete this.collection,i.remove()),this.collection&&Object.keys(this.collection).length){for(var l=0;l<this.collection.list.length;l++)if(this.collection.list[l].question_id===this.question_id){this.index=l;break}this.length=this.collection.list.length,this.showAnswer=this.collection.list[this.index].mark_answer,this.givenResult=this.collection.list[this.index].given_result,this.strike=this.collection.list[this.index].strike}this.loadQuestion()}return e.$inject=["Auth","Page","API","Collection","$routeParams","$window","$uibModal"],_createClass(e,[{key:"loadQuestion",value:function(){var e=this;this.API.get("questions/"+this.question_id+"/user/"+this.user.user_id).success(function(t){e.question=t.question,e.comments=t.comments,e.tags=[],t.tags&&(e.tags=t.tags.split(",").map(function(e){return{text:e}})),e.checkedAnswer=e.givenResult,e.showAnswer&&e.markAnswer(e.givenResult)})}},{key:"updateTags",value:function(){var e=this.tags.map(function(e){return e.text}).join(","),t={tags:e,question_id:this.question_id,user_id:this.user.user_id};this.API.post("tags",t,!0)}},{key:"saveStrike",value:function(){this.collection&&Object.keys(this.collection).length&&(this.collection.list[this.index].strike=this.strike,
this.Collection.set(this.collection))}},{key:"showSolution",value:function(){var e=this.question.correct_answer;this.checkedAnswer=e;var t=e===this.givenResult?1:0;(0===e||1===this.question.type)&&(t=-1);var s={correct:t,question_id:this.question_id,user_id:this.user.user_id,given_result:this.givenResult};this.API.post("results",s,!0),this.collection&&Object.keys(this.collection).length&&(this.collection.list[this.index].mark_answer=1,this.Collection.set(this.collection)),this.markAnswer(this.givenResult)}},{key:"saveAnswer",value:function(e){this.givenResult=e,this.collection&&Object.keys(this.collection).length&&(this.collection.list[this.index].given_result=this.givenResult,this.Collection.set(this.collection))}},{key:"markAnswer",value:function(e){this.isAnswerGiven=!0;var t=this.question.type;t>1&&(this.correctAnswer=this.question.correct_answer,this.checkedAnswer=e>0?e:this.correctAnswer,this.isAnswerRight=e===this.correctAnswer,this.isAnswerWrong=e!==this.correctAnswer,e!==this.correctAnswer&&(this.wrongAnswer=e))}},{key:"addComment",value:function(){var e=this,t=new Date/1e3,s={comment:this.commentText,question_id:this.question_id,reply_to:0,username:this.user.username,date:t};this.API.post("comments/"+this.user.user_id,s).success(function(t){s.voting=0,s.user_voting=0,s.comment_id=t.comment_id,e.comments.push(s),e.commentText=""})}},{key:"deleteComment",value:function(e){var t=this.comments[e].comment_id;this.API["delete"]("comments/"+t),this.comments.splice(e,1)}},{key:"changeUserVoting",value:function(e,t){e.user_voting=Math.min(Math.max(e.user_voting+t,-1),1);var s={user_voting:e.user_voting};this.API.post("comments/"+e.comment_id+"/user/"+this.user.user_id,s,!0)}},{key:"openImageModal",value:function(){var e=this;this.$uibModal.open({templateUrl:"imageModalContent.html",controller:"ModalInstanceController",controllerAs:"ctrl",resolve:{data:function(){return e.question.question_image_url}}})}}]),e}();angular.module("crucioApp").controller("QuestionController",QuestionController);var StatisticController=function i(e,t){_classCallCheck(this,i),t.setTitleAndNav("Statistik | Crucio","Lernen"),this.user=e.getUser()};StatisticController.$inject=["Auth","Page"],angular.module("crucioApp").controller("StatisticController",StatisticController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),LoginController=function(){function e(t,s,n){_classCallCheck(this,e),this.Auth=t,this.API=s,this.$document=n,this.user=this.Auth.tryGetUser(),this.rememberMe=!0}return e.$inject=["Auth","API","$document"],_createClass(e,[{key:"formChanged",value:function(){this.loginError=!1}},{key:"login",value:function(){var e=this;this.email||(this.email="");var t={email:this.email.replace("@","(@)"),remember_me:this.rememberMe,password:this.password};this.API.get("users/login",t).success(function(t){t.status?e.Auth.login(t.logged_in_user,e.rememberMe):e.loginError=!0})}},{key:"scrollToFeatures",value:function(){this.$document.scrollTopAnimated(1050,600)}}]),e}();angular.module("crucioApp").controller("LoginController",LoginController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),LogoutController=function(){function e(t,s){_classCallCheck(this,e),this.Page=s,this.Auth=t,this.user=t.getUser()}return e.$inject=["Auth","Page"],_createClass(e,[{key:"logout",value:function(){this.Auth.logout()}}]),e}();angular.module("crucioApp").controller("LogoutController",LogoutController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),RegisterController=function(){function e(t,s,n,i){_classCallCheck(this,e),this.API=s,this.$scope=n,this.$uibModal=i,this.user=t.tryGetUser(),this.semester=1,this.course=1}return e.$inject=["Auth","API","$scope","$uibModal"],_createClass(e,[{key:"formChanged",value:function(){var e=/[\wäüöÄÜÖ]*@studserv\.uni-leipzig\.de$/;this.$scope.form.email.$setValidity("studserv",e.test(this.mail)),this.$scope.form.passwordc.$setValidity("confirm",this.password===this.passwordc)}},{key:"register",value:function(){var e=this;this.$scope.form.username.$setValidity("duplicate",!0),this.$scope.form.email.$setValidity("duplicate",!0),this.isWorking=!0;var t={username:this.username,email:this.mail.replace("@","(@)"),semester:this.semester,course:this.course,password:this.password};this.API.post("users",t,!0).success(function(t){t.status&&e.$uibModal.open({templateUrl:"registerModalContent.html"}),e.isWorking=!1,e.$scope.form.username.$setValidity("duplicate","error_username_taken"!==t.error),e.$scope.form.email.$setValidity("duplicate","error_email_taken"!==t.error)})}}]),e}();angular.module("crucioApp").controller("RegisterController",RegisterController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),AccountController=function(){function e(t,s,n,i){_classCallCheck(this,e),this.API=n,this.Auth=s,this.$scope=i,t.setTitleAndNav("Account | Crucio","Name"),this.user=this.Auth.getUser()}return e.$inject=["Page","Auth","API","$scope"],_createClass(e,[{key:"formChanged",value:function(){this.$scope.form.passwordc.$setValidity("confirm",this.password===this.passwordc)}},{key:"saveUser",value:function(){var e=this;this.isSaved=!1,this.hasError=!1,this.isWorking=!0;var t={email:this.user.email.replace("@","(@)"),course_id:this.user.course_id,semester:this.user.semester,current_password:this.old_password,password:this.new_password};this.API.put("users/"+this.user.user_id+"/account",t,!0).success(function(t){t.status?(e.Auth.setUser(e.user),e.isSaved=!0):(e.user=e.Auth.getUser(),e.isSaved=!1,e.hasError=!0),e.wrong_password="error_incorrect_password"===t.error,e.isWorking=!1})}}]),e}();angular.module("crucioApp").controller("AccountController",AccountController);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),SettingsController=function(){function e(t,s,n){_classCallCheck(this,e),this.API=n,this.Auth=s,t.setTitleAndNav("Einstellungen | Crucio","Name"),this.user=this.Auth.getUser()}return e.$inject=["Page","Auth","API"],_createClass(e,[{key:"formChanged",value:function(){this.isSaved=!1,this.hasError=!1}},{key:"updateUser",value:function(){var e=this;this.formChanged(),this.isWorking=!0;var t={highlightExams:this.user.highlightExams,showComments:this.user.showComments,repetitionValue:50,useAnswers:this.user.useAnswers,useTags:this.user.useTags};this.API.put("users/"+this.user.user_id+"/settings",t,!0).success(function(t){t.status?(e.Auth.setUser(e.user),e.isSaved=!0):(e.user=e.Auth.getUser(),e.isSaved=!1,e.hasError=!0),e.isWorking=!1})}},{key:"removeAllResults",value:function(){this.API["delete"]("results/"+this.user.user_id)}}]),e}();angular.module("crucioApp").controller("SettingsController",SettingsController),angular.module("crucioApp").directive("timeago",TimeAgo),angular.module("crucioApp").filter("cut",Cut);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),API=function(){function e(t){_classCallCheck(this,e),this.$http=t,this.base="api/v1/"}return e.$inject=["$http"],_createClass(e,[{key:"get",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return this.$http.get(this.base+e,{ignoreLoadingBar:s,params:t})}},{key:"post",value:function(e,t){var s=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return this.$http.post(this.base+e,t,{ignoreLoadingBar:s})}},{key:"put",value:function(e,t){var s=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return this.$http.put(this.base+e,t,{ignoreLoadingBar:s})}},{key:"delete",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return this.$http["delete"](this.base+e,{ignoreLoadingBar:s,params:t})}}]),e}();angular.module("crucioApp").service("API",API);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),Auth=function(){function e(t,s){_classCallCheck(this,e),this.$window=s,this.$cookies=t}return e.$inject=["$cookies","$window"],_createClass(e,[{key:"getUser",value:function(){return this.tryGetUser(),this.user||this.$window.location.replace("/"),this.user}},{key:"tryGetUser",value:function(){return angular.isUndefined(this.user)&&angular.isDefined(this.$cookies.getObject("CrucioUser"))&&this.setUser(this.$cookies.getObject("CrucioUser")),this.user}},{key:"login",value:function(e,t){e.remember_user=t,this.setUser(e,!0),this.$window.location.assign("/learn")}},{key:"logout",value:function(){this.$cookies.remove("CrucioUser"),this.$window.location.assign(this.$window.location.origin)}},{key:"setUser",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];if(this.user=e,t||angular.isDefined(this.$cookies.getObject("CrucioUser"))){var s=new Date;s.setDate(s.getDate()+21),this.$cookies.putObject("CrucioUser",this.user,{expires:s})}}}]),e}();angular.module("crucioApp").service("Auth",Auth);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),Collection=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(){return angular.isUndefined(this.collection)&&angular.isDefined(sessionStorage.crucioCollection)&&this.set(angular.fromJson(sessionStorage.crucioCollection)),this.collection}},{key:"set",value:function(e){this.collection=e,sessionStorage.crucioCollection=angular.toJson(e)}},{key:"remove",value:function(){delete this.collection,sessionStorage.removeItem("crucioCollection")}},{key:"getWorked",value:function(){return this.get(),this.collection.list.filter(function(e){return e.given_result})}},{key:"analyseCount",value:function(){var e=this.getWorked(),t={correct_q:0,wrong_q:0,seen_q:0,solved_q:0,free_q:0,no_answer_q:0,all_q:this.collection.list.length,worked_q:e.length},s=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){var a=r.value;a.correct_answer===a.given_result&&a.given_result>0&&a.correct_answer>0&&t.correct_q++,a.correct_answer!==a.given_result&&a.given_result>0&&a.correct_answer>0&&t.wrong_q++,a.given_result>0&&t.solved_q++,a.given_result>-2&&t.seen_q++,1===a.type&&t.free_q++,0===a.correct_answer&&1!==a.type&&t.no_answer_q++}}catch(l){n=!0,i=l}finally{try{!s&&o["return"]&&o["return"]()}finally{if(n)throw i}}return t}}]),e}();angular.module("crucioApp").service("Collection",Collection);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),Page=function(){function e(t){_classCallCheck(this,e),this.$window=t}return e.$inject=["$window"],_createClass(e,[{key:"setTitle",value:function(e){this.title=e}},{key:"setNav",value:function(e){this.nav=e}},{key:"setTitleAndNav",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];this.title=e,this.nav=t,this.$window.document.title=this.title}}]),e}();angular.module("crucioApp").service("Page",Page);var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),Validate=function(){function e(t){var s=this;_classCallCheck(this,e),this.API=t,t.get("whitelist",{},!0).success(function(e){s.whitelist=e.whitelist})}return e.$inject=["API"],_createClass(e,[{key:"username",value:function(e){return e.length>4}},{key:"email",value:function(e){var t=/[\wäüöÄÜÖ]*@studserv\.uni-leipzig\.de$/;return t.test(e)?!0:this.whitelist&&this.whitelist.some(function(t){return t.mail_address===e})}},{key:"password",value:function(e){return e&&e.length>4}}]),e}();angular.module("crucioApp").service("Validate",Validate);